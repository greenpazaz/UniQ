```ini name=xen/hardened/cryptod.cfg
# cryptod hardened Xen domain (example)
name = "cryptod"
memory = 256
maxmem = 256
vcpus = 1
on_poweroff = 'destroy'
on_reboot = 'restart'
on_crash = 'restart'
# Disk: read-only base image + writable overlay
disk = [ 'file:/var/lib/xen/images/cryptod-base.img,xvda,r',
         'file:/var/lib/xen/images/cryptod-volatile.img,xvdb,w' ]
# Network: connect to isolated bridge, no promiscuous
vif = [ 'bridge=br0,ip=10.0.0.3' ]
# vchan ACL: only allow connections from specific DomIDs (entropyd=4,unlocker=5,policy_pd=6,netfw=7,ivm=8)
extra = "vchan-port=9001;vchan-allowed-domids=4,5,6,7,8"
# PCI passthrough: none allowed for cryptod (deny)
pci = []
# IOMMU: ensure no passthrough and disable device models that could expose DMA
# (Platform-specific; ensure hypervisor enforces IOMMU)
# Lock down domain capabilities
untrusted = 0
# Limit hypercalls: tighten grant-table settings if possible (platform-specific)
# cpuid masking: restrict CPU features available to the domain (platform-specific)
# File-system: ensure vaulted secrets are in an encrypted file accessible only inside cryptod
```
